<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bluesky Complete Real-time Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/date-fns@2.29.3/index.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1DA1F2 0%, #0d8bd9 100%);
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(29, 161, 242, 0.1), transparent);
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .header h1 {
            color: #1DA1F2;
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .nav-tabs {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
        }

        .nav-tab {
            background: #1DA1F2;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-tab:hover, .nav-tab.active {
            background: #0d8bd9;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(29, 161, 242, 0.4);
        }

        .live-indicator {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .status-badge {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background: rgba(40, 167, 69, 0.1);
            border: 2px solid #28a745;
            border-radius: 25px;
            font-weight: 500;
        }

        .pulse-dot {
            width: 12px;
            height: 12px;
            background: #28a745;
            border-radius: 50%;
            animation: pulse 1.5s infinite;
            box-shadow: 0 0 10px rgba(40, 167, 69, 0.5);
        }

        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.7; }
            100% { transform: scale(1); opacity: 1; }
        }

        .page-content {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }

        .page-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .main-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .stat-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
        }

        .stat-card.updating {
            animation: cardPulse 1s ease-in-out;
        }

        @keyframes cardPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, #1DA1F2, #0d8bd9, #667eea);
        }

        .stat-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            background: linear-gradient(135deg, #1DA1F2, #667eea);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            color: #1DA1F2;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .stat-label {
            color: #666;
            font-size: 1.1rem;
            margin-bottom: 15px;
            font-weight: 500;
        }

        .stat-change {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .stat-change.positive {
            background: rgba(40, 167, 69, 0.1);
            color: #28a745;
            border: 1px solid rgba(40, 167, 69, 0.3);
        }

        .stat-change.negative {
            background: rgba(220, 53, 69, 0.1);
            color: #dc3545;
            border: 1px solid rgba(220, 53, 69, 0.3);
        }

        .data-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .data-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .panel-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 3px solid #1DA1F2;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .chart-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 25px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .data-list {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-height: 500px;
            overflow-y: auto;
        }

        .data-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin-bottom: 10px;
            background: rgba(29, 161, 242, 0.05);
            border-radius: 15px;
            border-left: 4px solid #1DA1F2;
            transition: all 0.3s ease;
        }

        .data-item:hover {
            transform: translateX(5px);
            background: rgba(29, 161, 242, 0.1);
        }

        .data-item.new-item {
            animation: newItemSlide 1s ease-out;
            background: rgba(40, 167, 69, 0.1);
            border-left-color: #28a745;
        }

        @keyframes newItemSlide {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .item-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .item-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, #1DA1F2, #667eea);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .item-details {
            flex: 1;
        }

        .item-name {
            font-weight: bold;
            margin-bottom: 5px;
            color: #333;
        }

        .item-handle {
            color: #666;
            font-size: 0.9rem;
        }

        .item-timestamp {
            color: #999;
            font-size: 0.8rem;
        }

        .count-badge {
            background: linear-gradient(135deg, #1DA1F2, #0d8bd9);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .status {
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .status-active { background: #d4edda; color: #155724; }
        .status-verified { background: #cce5ff; color: #004085; }
        .status-pending { background: #fff3cd; color: #856404; }
        .status-blocked { background: #f8d7da; color: #721c24; }
        .status-suspicious { background: #ffeaa7; color: #6c5ce7; }

        .time-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .time-card {
            background: linear-gradient(135deg, #1DA1F2 0%, #0d8bd9 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            transition: transform 0.3s ease;
        }

        .time-card:hover {
            transform: translateY(-3px);
        }

        .time-period {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-bottom: 8px;
        }

        .time-count {
            font-size: 1.8rem;
            font-weight: bold;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .control-btn {
            background: #1DA1F2;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .control-btn:hover {
            background: #0d8bd9;
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(29, 161, 242, 0.4);
        }

        .footer-stats {
            text-align: center;
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
            margin-top: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        /* Fixed Clickable username styles */
        .clickable-username {
            color: #1DA1F2 !important;
            cursor: pointer;
            text-decoration: none;
            transition: all 0.3s ease;
            position: relative;
            display: inline-block;
            font-weight: bold;
        }

        .clickable-username:hover {
            color: #0d8bd9 !important;
            text-decoration: underline;
            transform: translateX(2px);
        }

        .clickable-username::after {
            content: '🔗';
            font-size: 0.7rem;
            margin-left: 5px;
            opacity: 0;
            transition: opacity 0.3s ease;
            position: absolute;
            top: -2px;
        }

        .clickable-username:hover::after {
            opacity: 1;
        }

        .clickable-handle {
            color: #1DA1F2 !important;
            cursor: pointer;
            text-decoration: none;
            transition: all 0.3s ease;
            font-size: 0.85rem;
            display: inline-block;
        }

        .clickable-handle:hover {
            color: #0d8bd9 !important;
            text-decoration: underline;
            transform: translateX(1px);
        }

        /* Enhanced tooltip */
        .bluesky-tooltip {
            position: relative;
            display: inline-block;
        }

        .bluesky-tooltip .tooltip-text {
            visibility: hidden;
            width: 140px;
            background-color: rgba(0, 0, 0, 0.9);
            color: #fff;
            text-align: center;
            border-radius: 8px;
            padding: 8px;
            position: absolute;
            z-index: 1000;
            bottom: 125%;
            left: 50%;
            margin-left: -70px;
            opacity: 0;
            transition: opacity 0.3s, visibility 0.3s;
            font-size: 0.75rem;
            font-weight: normal;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .bluesky-tooltip .tooltip-text::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: rgba(0, 0, 0, 0.9) transparent transparent transparent;
        }

        .bluesky-tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        /* Click feedback animation */
        .click-feedback {
            animation: clickPulse 0.3s ease-out;
        }

        @keyframes clickPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 2.5rem;
            }
            
            .main-stats {
                grid-template-columns: 1fr;
            }
            
            .data-grid {
                grid-template-columns: 1fr;
            }
            
            .nav-tabs {
                flex-direction: column;
                align-items: center;
            }
            
            .nav-tab {
                width: 100%;
                max-width: 300px;
                justify-content: center;
            }

            .bluesky-tooltip .tooltip-text {
                width: 120px;
                margin-left: -60px;
                font-size: 0.7rem;
            }
        }

        /* Custom scrollbar */
        .data-list::-webkit-scrollbar {
            width: 8px;
        }

        .data-list::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.1);
            border-radius: 10px;
        }

        .data-list::-webkit-scrollbar-thumb {
            background: #1DA1F2;
            border-radius: 10px;
        }

        .data-list::-webkit-scrollbar-thumb:hover {
            background: #0d8bd9;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>🚀 Bluesky Complete Real-time Dashboard</h1>
            <p>Comprehensive live analytics for all Bluesky metrics</p>
            
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="showPage('overview')" id="tab-overview">
                    <span>📊</span> Overview
                </button>
                <button class="nav-tab" onclick="showPage('domain-handles')" id="tab-domain-handles">
                    <span>🌐</span> Domain Handles
                </button>
                <button class="nav-tab" onclick="showPage('daily-signups')" id="tab-daily-signups">
                    <span>⏰</span> Daily Sign-ups
                </button>
                <button class="nav-tab" onclick="showPage('country-stats')" id="tab-country-stats">
                    <span>🌍</span> Country Stats
                </button>
                <button class="nav-tab" onclick="showPage('bot-activity')" id="tab-bot-activity">
                    <span>🤖</span> Bot Activity
                </button>
                <button class="nav-tab" onclick="showPage('blue-check')" id="tab-blue-check">
                    <span>✅</span> Blue Check
                </button>
                <button class="nav-tab" onclick="showPage('verified-users')" id="tab-verified-users">
                    <span>👤</span> Verified Users
                </button>
                <button class="nav-tab" onclick="showPage('check-stats')" id="tab-check-stats">
                    <span>📈</span> Check Statistics
                </button>
            </div>
            
            <div class="live-indicator">
                <div class="status-badge">
                    <div class="pulse-dot"></div>
                    <span>Live Data Stream</span>
                </div>
                <div class="status-badge" style="border-color: #1DA1F2; background: rgba(29, 161, 242, 0.1);">
                    <span>⚡</span>
                    <span>Updates every <span id="update-interval">2</span> seconds</span>
                </div>
            </div>
        </div>

        <!-- Controls -->
        <div class="controls">
            <button class="control-btn" onclick="toggleUpdates()" id="toggle-btn">
                <span>⏸️</span>
                <span>Pause Updates</span>
            </button>
            <button class="control-btn" onclick="refreshAllData()">
                <span>🔄</span>
                <span>Refresh Now</span>
            </button>
            <button class="control-btn" onclick="exportData()">
                <span>📊</span>
                <span>Export Data</span>
            </button>
            <button class="control-btn" onclick="toggleSpeed()">
                <span>⚡</span>
                <span id="speed-text">Normal Speed</span>
            </button>
        </div>

        <!-- Overview Page -->
        <div id="page-overview" class="page-content active">
            <div class="main-stats">
                <div class="stat-card">
                    <div class="stat-icon">👥</div>
                    <div class="stat-number" id="total-users">36,135,131</div>
                    <div class="stat-label">Total Users</div>
                    <div class="stat-change positive" id="users-change">
                        <span>↗</span><span>+0.23%</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">📝</div>
                    <div class="stat-number" id="total-posts">1.52B</div>
                    <div class="stat-label">Total Posts</div>
                    <div class="stat-change positive" id="posts-change">
                        <span>↗</span><span>+1.45%</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">🔗</div>
                    <div class="stat-number" id="total-follows">2.68B</div>
                    <div class="stat-label">Total Follows</div>
                    <div class="stat-change positive" id="follows-change">
                        <span>↗</span><span>+2.12%</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">❤️</div>
                    <div class="stat-number" id="total-likes">107.17M</div>
                    <div class="stat-label">Total Likes</div>
                    <div class="stat-change positive" id="likes-change">
                        <span>↗</span><span>+3.67%</span>
                    </div>
                </div>
            </div>

            <div class="chart-container">
                <div class="chart-title">
                    <span>📊</span>
                    <span>Real-time Growth Overview</span>
                </div>
                <canvas id="overviewChart" width="400" height="200"></canvas>
            </div>
        </div>

        <!-- Domain Handles Page -->
        <div id="page-domain-handles" class="page-content">
            <div class="main-stats">
                <div class="stat-card">
                    <div class="stat-icon">🔗</div>
                    <div class="stat-number" id="bsky-handles">2.1M</div>
                    <div class="stat-label">bsky.social handles</div>
                    <div class="stat-change positive" id="bsky-handles-change">
                        <span>↗</span><span>+0.8%</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">🌐</div>
                    <div class="stat-number" id="custom-handles">450K</div>
                    <div class="stat-label">Custom domain handles</div>
                    <div class="stat-change positive" id="custom-handles-change">
                        <span>↗</span><span>+2.3%</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">🆕</div>
                    <div class="stat-number" id="new-handles-today">25K</div>
                    <div class="stat-label">New handles today</div>
                    <div class="stat-change positive" id="new-handles-change">
                        <span>↗</span><span>+4.1%</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">📊</div>
                    <div class="stat-number" id="custom-ratio">16%</div>
                    <div class="stat-label">Custom domain ratio</div>
                    <div class="stat-change positive" id="custom-ratio-change">
                        <span>↗</span><span>+0.3%</span>
                    </div>
                </div>
            </div>

            <div class="chart-container">
                <div class="chart-title">
                    <span>🌐</span>
                    <span>Domain Handle Distribution</span>
                </div>
                <canvas id="domainChart" width="400" height="200"></canvas>
            </div>

            <div class="data-list">
                <div class="panel-title">
                    <span>🏆</span>
                    <span>Top Custom Domains (Live)</span>
                </div>
                <div id="domain-list">
                    <!-- Dynamic content -->
                </div>
            </div>
        </div>

        <!-- Daily Sign-ups Page -->
        <div id="page-daily-signups" class="page-content">
            <div class="main-stats">
                <div class="stat-card">
                    <div class="stat-icon">📊</div>
                    <div class="stat-number" id="signups-total">12.5K</div>
                    <div class="stat-label">Total Today</div>
                    <div class="stat-change positive" id="signups-total-change">
                        <span>↗</span><span>+1.8%</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">⏰</div>
                    <div class="stat-number" id="peak-hour">18:00</div>
                    <div class="stat-label">Peak Hour</div>
                    <div class="stat-change">Peak</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">🔥</div>
                    <div class="stat-number" id="peak-count">750</div>
                    <div class="stat-label">Peak Hour Count</div>
                    <div class="stat-change positive" id="peak-count-change">
                        <span>↗</span><span>+5.2%</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">📈</div>
                    <div class="stat-number" id="avg-rate">520</div>
                    <div class="stat-label">Average Rate/Hour</div>
                    <div class="stat-change positive" id="avg-rate-change">
                        <span>↗</span><span>+2.1%</span>
                    </div>
                </div>
            </div>

            <div class="chart-container">
                <div class="chart-title">
                    <span>⏰</span>
                    <span>Hourly Sign-ups (Live)</span>
                </div>
                <canvas id="hourlyChart" width="400" height="200"></canvas>
            </div>

            <div class="time-grid">
                <div class="time-card">
                    <div class="time-period">🌙 00:00 - 06:00</div>
                    <div class="time-count" id="time-0-6">1,250</div>
                </div>
                <div class="time-card">
                    <div class="time-period">🌅 06:00 - 12:00</div>
                    <div class="time-count" id="time-6-12">3,800</div>
                </div>
                <div class="time-card">
                    <div class="time-period">☀️ 12:00 - 18:00</div>
                    <div class="time-count" id="time-12-18">4,200</div>
                </div>
                <div class="time-card">
                    <div class="time-period">🌆 18:00 - 24:00</div>
                    <div class="time-count" id="time-18-24">3,250</div>
                </div>
            </div>
        </div>

        <!-- Country Stats Page -->
        <div id="page-country-stats" class="page-content">
            <div class="main-stats">
                <div class="stat-card">
                    <div class="stat-icon">🌍</div>
                    <div class="stat-number" id="countries-active">195</div>
                    <div class="stat-label">Countries Active</div>
                    <div class="stat-change">Active</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">🆕</div>
                    <div class="stat-number" id="country-handles-today">45K</div>
                    <div class="stat-label">New Handles Today</div>
                    <div class="stat-change positive" id="country-handles-change">
                        <span>↗</span><span>+3.5%</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">🏆</div>
                    <div class="stat-number">🇺🇸 USA</div>
                    <div class="stat-label">Top Country</div>
                    <div class="stat-change">Top</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">📈</div>
                    <div class="stat-number" id="global-growth">+12%</div>
                    <div class="stat-label">Global Growth</div>
                    <div class="stat-change positive" id="global-growth-change">
                        <span>↗</span><span>+0.8%</span>
                    </div>
                </div>
            </div>

            <div class="chart-container">
                <div class="chart-title">
                    <span>🌍</span>
                    <span>Top Countries - New Domain Handles</span>
                </div>
                <canvas id="countryChart" width="400" height="200"></canvas>
            </div>

            <div class="data-list">
                <div class="panel-title">
                    <span>🏆</span>
                    <span>Country Rankings (Live)</span>
                </div>
                <div id="country-list">
                    <!-- Dynamic content -->
                </div>
            </div>
        </div>

        <!-- Bot Activity Page -->
        <div id="page-bot-activity" class="page-content">
            <div class="main-stats">
                <div class="stat-card">
                    <div class="stat-icon">🔍</div>
                    <div class="stat-number" id="detected-bots">15.2K</div>
                    <div class="stat-label">Detected Bots</div>
                    <div class="stat-change positive" id="detected-bots-change">
                        <span>↗</span><span>+1.2%</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">📊</div>
                    <div class="stat-number" id="bot-percentage">5.4%</div>
                    <div class="stat-label">Bot Percentage</div>
                    <div class="stat-change positive" id="bot-percentage-change">
                        <span>↗</span><span>+0.1%</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">⚡</div>
                    <div class="stat-number" id="bots-active">2.8K</div>
                    <div class="stat-label">Active Today</div>
                    <div class="stat-change positive" id="bots-active-change">
                        <span>↗</span><span>+2.8%</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">🚫</div>
                    <div class="stat-number" id="bots-blocked">890</div>
                    <div class="stat-label">Blocked Today</div>
                    <div class="stat-change positive" id="bots-blocked-change">
                        <span>↗</span><span>+15.3%</span>
                    </div>
                </div>
            </div>

            <div class="chart-container">
                <div class="chart-title">
                    <span>🤖</span>
                    <span>Bot Activity vs Normal Users</span>
                </div>
                <canvas id="botChart" width="400" height="200"></canvas>
            </div>

            <div class="data-list">
                <div class="panel-title">
                    <span>🔍</span>
                    <span>Detected Bots (Live)</span>
                </div>
                <div id="bot-list">
                    <!-- Dynamic content -->
                </div>
            </div>
        </div>

        <!-- Blue Check Page -->
        <div id="page-blue-check" class="page-content">
            <div class="main-stats">
                <div class="stat-card">
                    <div class="stat-icon">🆕</div>
                    <div class="stat-number" id="new-verified">1.2K</div>
                    <div class="stat-label">New Verified Today</div>
                    <div class="stat-change positive" id="new-verified-change">
                        <span>↗</span><span>+8.5%</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">⏳</div>
                    <div class="stat-number" id="pending-verification">3.8K</div>
                    <div class="stat-label">Pending Verification</div>
                    <div class="stat-change positive" id="pending-verification-change">
                        <span>↗</span><span>+12.3%</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">✅</div>
                    <div class="stat-number" id="verification-rate">78%</div>
                    <div class="stat-label">Approval Rate</div>
                    <div class="stat-change positive" id="verification-rate-change">
                        <span>↗</span><span>+2.1%</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">⏱️</div>
                    <div class="stat-number" id="avg-processing">2.3h</div>
                    <div class="stat-label">Avg Processing Time</div>
                    <div class="stat-change negative" id="avg-processing-change">
                        <span>↘</span><span>-5.2%</span>
                    </div>
                </div>
            </div>

            <div class="chart-container">
                <div class="chart-title">
                    <span>✅</span>
                    <span>Daily Verifications (Live)</span>
                </div>
                <canvas id="verificationChart" width="400" height="200"></canvas>
            </div>

            <div class="data-list">
                <div class="panel-title">
                    <span>🆕</span>
                    <span>Recent Verifications (Live)</span>
                </div>
                <div id="verification-list">
                    <!-- Dynamic content -->
                </div>
            </div>
        </div>

        <!-- Verified Users Page -->
        <div id="page-verified-users" class="page-content">
            <div class="main-stats">
                <div class="stat-card">
                    <div class="stat-icon">📊</div>
                    <div class="stat-number" id="total-verified">45.2K</div>
                    <div class="stat-label">Total Verified Users</div>
                    <div class="stat-change positive" id="total-verified-change">
                        <span>↗</span><span>+1.8%</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">📈</div>
                    <div class="stat-number" id="verified-percentage">1.6%</div>
                    <div class="stat-label">Verified Percentage</div>
                    <div class="stat-change positive" id="verified-percentage-change">
                        <span>↗</span><span>+0.2%</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">⚡</div>
                    <div class="stat-number" id="verified-active">12.8K</div>
                    <div class="stat-label">Active Verified Today</div>
                    <div class="stat-change positive" id="verified-active-change">
                        <span>↗</span><span>+3.2%</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">🏆</div>
                    <div class="stat-number">📰</div>
                    <div class="stat-label">Top Category: Journalists</div>
                    <div class="stat-change">Stable</div>
                </div>
            </div>

            <div class="chart-container">
                <div class="chart-title">
                    <span>👤</span>
                    <span>Verified User Categories</span>
                </div>
                <canvas id="verifiedCategoryChart" width="400" height="200"></canvas>
            </div>

            <div class="data-list">
                <div class="panel-title">
                    <span>⭐</span>
                    <span>Popular Verified Users (Live)</span>
                </div>
                <div id="verified-users-list">
                    <!-- Dynamic content -->
                </div>
            </div>
        </div>

        <!-- Check Statistics Page -->
        <div id="page-check-stats" class="page-content">
            <div class="main-stats">
                <div class="stat-card">
                    <div class="stat-icon">📊</div>
                    <div class="stat-number" id="total-verified-accounts">89.5K</div>
                    <div class="stat-label">Total Verified Accounts</div>
                    <div class="stat-change positive" id="total-verified-accounts-change">
                        <span>↗</span><span>+2.1%</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">⚡</div>
                    <div class="stat-number" id="active-trusted">23.4K</div>
                    <div class="stat-label">Active Trusted Verifiers</div>
                    <div class="stat-change positive" id="active-trusted-change">
                        <span>↗</span><span>+5.8%</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">🆕</div>
                    <div class="stat-number" id="recent-verifications">1.56K</div>
                    <div class="stat-label">Recent Verifications</div>
                    <div class="stat-change positive" id="recent-verifications-change">
                        <span>↗</span><span>+12.3%</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">🏆</div>
                    <div class="stat-number" id="top-verifiers">92</div>
                    <div class="stat-label">Top Trusted Verifiers</div>
                    <div class="stat-change positive" id="top-verifiers-change">
                        <span>↗</span><span>+8.7%</span>
                    </div>
                </div>
            </div>

            <div class="chart-container">
                <div class="chart-title">
                    <span>📊</span>
                    <span>Verification Trends (30 Days)</span>
                </div>
                <canvas id="checkStatsChart" width="400" height="200"></canvas>
            </div>

            <div class="data-list">
                <div class="panel-title">
                    <span>🏆</span>
                    <span>Top Trusted Verifiers (Live)</span>
                </div>
                <div id="trusted-verifiers-list">
                    <!-- Dynamic content -->
                </div>
            </div>
        </div>

        <!-- Footer Stats -->
        <div class="footer-stats">
            <strong>System Status:</strong> All systems operational • 
            <strong>Uptime:</strong> <span id="uptime">00:00:00</span> • 
            <strong>Data Points:</strong> <span id="data-points">0</span> • 
            <strong>Last Update:</strong> <span id="last-update">Never</span>
        </div>
    </div>

    <script>
        // Complete Real-time System with Fixed Clickable Usernames
        class BlueskyCompleteSystem {
            constructor() {
                this.isRunning = true;
                this.updateInterval = 2000;
                this.speedMode = 'normal';
                this.startTime = Date.now();
                this.dataPoints = 0;
                this.charts = {};
                this.currentPage = 'overview';
                
                // Base data for all sections
                this.baseData = {
                    // Overview
                    users: 36135131,
                    posts: 1520000000,
                    follows: 2680000000,
                    likes: 107170000,
                    
                    // Domain handles
                    bskyHandles: 2100000,
                    customHandles: 450000,
                    newHandlesToday: 25000,
                    customRatio: 16,
                    
                    // Daily signups
                    signupsTotal: 12500,
                    peakHour: 18,
                    peakCount: 750,
                    avgRate: 520,
                    timeSlots: [1250, 3800, 4200, 3250],
                    
                    // Country stats
                    countriesActive: 195,
                    countryHandlesToday: 45000,
                    globalGrowth: 12,
                    
                    // Bot activity
                    detectedBots: 15200,
                    botPercentage: 5.4,
                    botsActive: 2800,
                    botsBlocked: 890,
                    
                    // Blue check
                    newVerified: 1200,
                    pendingVerification: 3800,
                    verificationRate: 78,
                    avgProcessing: 2.3,
                    
                    // Verified users
                    totalVerified: 45200,
                    verifiedPercentage: 1.6,
                    verifiedActive: 12800,
                    
                    // Check statistics
                    totalVerifiedAccounts: 89500,
                    activeTrusted: 23400,
                    recentVerifications: 1560,
                    topVerifiers: 92
                };
                
                this.init();
            }

            init() {
                console.log('🚀 Initializing Complete Bluesky System...');
                
                this.initializeCharts();
                this.startRealTimeUpdates();
                this.startUptimeCounter();
                this.updateAllLists();
                
                console.log('✅ Complete system initialized');
            }

            // Enhanced function to open Bluesky profile with error handling
            openBlueskyProfile(handle) {
                try {
                    // Remove @ symbol if present and clean the handle
                    let cleanHandle = handle.replace('@', '').trim();
                    
                    // Validate handle format
                    if (!cleanHandle || cleanHandle.length === 0) {
                        console.error('❌ Invalid handle:', handle);
                        return;
                    }
                    
                    // Construct Bluesky URL
                    const blueskyUrl = `https://bsky.app/profile/${cleanHandle}`;
                    
                    // Add click feedback animation
                    const clickedElement = event?.target;
                    if (clickedElement) {
                        clickedElement.classList.add('click-feedback');
                        setTimeout(() => {
                            clickedElement.classList.remove('click-feedback');
                        }, 300);
                    }
                    
                    // Open in new tab with security attributes
                    const newWindow = window.open(blueskyUrl, '_blank', 'noopener,noreferrer');
                    
                    // Check if popup was blocked
                    if (!newWindow || newWindow.closed || typeof newWindow.closed === 'undefined') {
                        console.warn('⚠️ Popup blocked, trying alternative method');
                        // Fallback: create a temporary link and click it
                        const tempLink = document.createElement('a');
                        tempLink.href = blueskyUrl;
                        tempLink.target = '_blank';
                        tempLink.rel = 'noopener noreferrer';
                        document.body.appendChild(tempLink);
                        tempLink.click();
                        document.body.removeChild(tempLink);
                    }
                    
                    // Log for analytics
                    console.log(`🔗 Opening Bluesky profile: ${blueskyUrl}`);
                    
                } catch (error) {
                    console.error('❌ Error opening Bluesky profile:', error);
                    alert('Sorry, there was an error opening the profile. Please try again.');
                }
            }

            // Create clickable element with proper event handling
            createClickableElement(text, handle, className = 'clickable-username') {
                return `
                    <span class="bluesky-tooltip">
                        <span class="${className}" onclick="window.blueskySystem.openBlueskyProfile('${handle.replace(/'/g, "\\'")}'); event.stopPropagation();">
                            ${text}
                        </span>
                        <span class="tooltip-text">Click to open in Bluesky</span>
                    </span>
                `;
            }

            // Real-time data generation
            generateRealisticGrowth(baseValue, growthRate = 0.001, variance = 0.0002) {
                const randomFactor = (Math.random() - 0.5) * variance;
                const timeBasedFactor = Math.sin(Date.now() / 100000) * (variance / 2);
                const finalGrowthRate = growthRate + randomFactor + timeBasedFactor;
                
                return Math.floor(baseValue * (1 + finalGrowthRate));
            }

            updateAllData() {
                // Overview data
                this.baseData.users = this.generateRealisticGrowth(this.baseData.users, 0.0001);
                this.baseData.posts = this.generateRealisticGrowth(this.baseData.posts, 0.0002);
                this.baseData.follows = this.generateRealisticGrowth(this.baseData.follows, 0.0003);
                this.baseData.likes = this.generateRealisticGrowth(this.baseData.likes, 0.0005);

                // Domain handles data
                this.baseData.bskyHandles = this.generateRealisticGrowth(this.baseData.bskyHandles, 0.0001);
                this.baseData.customHandles = this.generateRealisticGrowth(this.baseData.customHandles, 0.0003);
                this.baseData.newHandlesToday = this.generateRealisticGrowth(this.baseData.newHandlesToday, 0.001);
                this.baseData.customRatio = Math.max(15, Math.min(20, this.baseData.customRatio + (Math.random() - 0.5) * 0.1));

                // Daily signups data
                this.baseData.signupsTotal = this.generateRealisticGrowth(this.baseData.signupsTotal, 0.0008);
                this.baseData.peakCount = this.generateRealisticGrowth(this.baseData.peakCount, 0.002);
                this.baseData.avgRate = this.generateRealisticGrowth(this.baseData.avgRate, 0.001);
                
                // Update time slots
                this.baseData.timeSlots = this.baseData.timeSlots.map(slot => 
                    this.generateRealisticGrowth(slot, 0.001)
                );

                // Country stats data
                this.baseData.countryHandlesToday = this.generateRealisticGrowth(this.baseData.countryHandlesToday, 0.0005);
                this.baseData.globalGrowth = Math.max(10, Math.min(15, this.baseData.globalGrowth + (Math.random() - 0.5) * 0.2));

                // Bot activity data
                this.baseData.detectedBots = this.generateRealisticGrowth(this.baseData.detectedBots, 0.0002);
                this.baseData.botPercentage = Math.max(4, Math.min(7, this.baseData.botPercentage + (Math.random() - 0.5) * 0.1));
                this.baseData.botsActive = this.generateRealisticGrowth(this.baseData.botsActive, 0.001);
                this.baseData.botsBlocked = this.generateRealisticGrowth(this.baseData.botsBlocked, 0.005);

                // Blue check data
                this.baseData.newVerified = this.generateRealisticGrowth(this.baseData.newVerified, 0.003);
                this.baseData.pendingVerification = this.generateRealisticGrowth(this.baseData.pendingVerification, 0.002);
                this.baseData.verificationRate = Math.max(70, Math.min(85, this.baseData.verificationRate + (Math.random() - 0.5) * 0.5));
                this.baseData.avgProcessing = Math.max(1.5, Math.min(4, this.baseData.avgProcessing + (Math.random() - 0.5) * 0.1));

                // Verified users data
                this.baseData.totalVerified = this.generateRealisticGrowth(this.baseData.totalVerified, 0.0003);
                this.baseData.verifiedPercentage = Math.max(1.4, Math.min(2, this.baseData.verifiedPercentage + (Math.random() - 0.5) * 0.01));
                this.baseData.verifiedActive = this.generateRealisticGrowth(this.baseData.verifiedActive, 0.001);

                // Check statistics data
                this.baseData.totalVerifiedAccounts = this.generateRealisticGrowth(this.baseData.totalVerifiedAccounts, 0.0002);
                this.baseData.activeTrusted = this.generateRealisticGrowth(this.baseData.activeTrusted, 0.0004);
                this.baseData.recentVerifications = this.generateRealisticGrowth(this.baseData.recentVerifications, 0.003);
                this.baseData.topVerifiers = this.generateRealisticGrowth(this.baseData.topVerifiers, 0.001);

                this.updateUI();
                this.dataPoints++;
            }

            updateUI() {
                // Overview
                this.updateElement('total-users', this.formatNumber(this.baseData.users));
                this.updateElement('total-posts', this.formatNumber(this.baseData.posts));
                this.updateElement('total-follows', this.formatNumber(this.baseData.follows));
                this.updateElement('total-likes', this.formatNumber(this.baseData.likes));

                // Domain handles
                this.updateElement('bsky-handles', this.formatNumber(this.baseData.bskyHandles));
                this.updateElement('custom-handles', this.formatNumber(this.baseData.customHandles));
                this.updateElement('new-handles-today', this.formatNumber(this.baseData.newHandlesToday));
                this.updateElement('custom-ratio', this.baseData.customRatio.toFixed(1) + '%');

                // Daily signups
                this.updateElement('signups-total', this.formatNumber(this.baseData.signupsTotal));
                this.updateElement('peak-count', this.formatNumber(this.baseData.peakCount));
                this.updateElement('avg-rate', this.formatNumber(this.baseData.avgRate));
                
                // Update time slots
                this.updateElement('time-0-6', this.formatNumber(this.baseData.timeSlots[0]));
                this.updateElement('time-6-12', this.formatNumber(this.baseData.timeSlots[1]));
                this.updateElement('time-12-18', this.formatNumber(this.baseData.timeSlots[2]));
                this.updateElement('time-18-24', this.formatNumber(this.baseData.timeSlots[3]));

                // Country stats
                this.updateElement('country-handles-today', this.formatNumber(this.baseData.countryHandlesToday));
                this.updateElement('global-growth', '+' + this.baseData.globalGrowth.toFixed(1) + '%');

                // Bot activity
                this.updateElement('detected-bots', this.formatNumber(this.baseData.detectedBots));
                this.updateElement('bot-percentage', this.baseData.botPercentage.toFixed(1) + '%');
                this.updateElement('bots-active', this.formatNumber(this.baseData.botsActive));
                this.updateElement('bots-blocked', this.formatNumber(this.baseData.botsBlocked));

                // Blue check
                this.updateElement('new-verified', this.formatNumber(this.baseData.newVerified));
                this.updateElement('pending-verification', this.formatNumber(this.baseData.pendingVerification));
                this.updateElement('verification-rate', this.baseData.verificationRate.toFixed(0) + '%');
                this.updateElement('avg-processing', this.baseData.avgProcessing.toFixed(1) + 'h');

                // Verified users
                this.updateElement('total-verified', this.formatNumber(this.baseData.totalVerified));
                this.updateElement('verified-percentage', this.baseData.verifiedPercentage.toFixed(1) + '%');
                this.updateElement('verified-active', this.formatNumber(this.baseData.verifiedActive));

                // Check statistics
                this.updateElement('total-verified-accounts', this.formatNumber(this.baseData.totalVerifiedAccounts));
                this.updateElement('active-trusted', this.formatNumber(this.baseData.activeTrusted));
                this.updateElement('recent-verifications', this.formatNumber(this.baseData.recentVerifications));
                this.updateElement('top-verifiers', this.formatNumber(this.baseData.topVerifiers));

                this.updateChangeIndicators();
                this.updateSystemStats();
            }

            updateElement(id, value) {
                const element = document.getElementById(id);
                if (element && element.textContent !== value) {
                    element.textContent = value;
                    const card = element.closest('.stat-card');
                    if (card) {
                        card.classList.add('updating');
                        setTimeout(() => card.classList.remove('updating'), 1000);
                    }
                }
            }

            updateChangeIndicators() {
                const changes = [
                    { id: 'users-change', value: this.generateRandomChange(0.1, 0.5) },
                    { id: 'posts-change', value: this.generateRandomChange(0.8, 2.0) },
                    { id: 'follows-change', value: this.generateRandomChange(1.5, 3.0) },
                    { id: 'likes-change', value: this.generateRandomChange(2.0, 5.0) },
                    { id: 'bsky-handles-change', value: this.generateRandomChange(0.5, 1.2) },
                    { id: 'custom-handles-change', value: this.generateRandomChange(1.8, 3.5) },
                    { id: 'new-handles-change', value: this.generateRandomChange(3.0, 5.0) },
                    { id: 'custom-ratio-change', value: this.generateRandomChange(0.1, 0.5) }
                ];

                changes.forEach(change => {
                    const element = document.getElementById(change.id);
                    if (element) {
                        const isPositive = change.value > 0;
                        element.className = `stat-change ${isPositive ? 'positive' : 'negative'}`;
                        element.innerHTML = `
                            <span>${isPositive ? '↗' : '↘'}</span>
                            <span>${isPositive ? '+' : ''}${change.value.toFixed(2)}%</span>
                        `;
                    }
                });
            }

            generateRandomChange(min, max) {
                return Math.random() * (max - min) + min;
            }

            formatNumber(num) {
                if (num >= 1000000000) {
                    return (num / 1000000000).toFixed(2) + 'B';
                } else if (num >= 1000000) {
                    return (num / 1000000).toFixed(2) + 'M';
                } else if (num >= 1000) {
                    return (num / 1000).toFixed(1) + 'K';
                }
                return num.toLocaleString();
            }

            // Chart initialization (keeping existing charts)
            initializeCharts() {
                this.initOverviewChart();
                this.initDomainChart();
                this.initHourlyChart();
                this.initCountryChart();
                this.initBotChart();
                this.initVerificationChart();
                this.initVerifiedCategoryChart();
                this.initCheckStatsChart();
            }

            initOverviewChart() {
                const ctx = document.getElementById('overviewChart')?.getContext('2d');
                if (!ctx) return;

                this.charts.overview = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: Array.from({length: 24}, (_, i) => `${String(i).padStart(2, '0')}:00`),
                        datasets: [{
                            label: 'Users',
                            data: Array.from({length: 24}, () => Math.floor(Math.random() * 1000 + 500)),
                            borderColor: '#1DA1F2',
                            backgroundColor: 'rgba(29, 161, 242, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: { legend: { display: false } },
                        scales: {
                            y: { beginAtZero: true, grid: { color: 'rgba(0, 0, 0, 0.1)' } },
                            x: { grid: { color: 'rgba(0, 0, 0, 0.1)' } }
                        }
                    }
                });
            }

            initDomainChart() {
                const ctx = document.getElementById('domainChart')?.getContext('2d');
                if (!ctx) return;

                this.charts.domain = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: ['bsky.social', 'Custom Domains', 'Other'],
                        datasets: [{
                            data: [2100000, 450000, 250000],
                            backgroundColor: [
                                'rgba(29, 161, 242, 0.8)',
                                'rgba(102, 126, 234, 0.8)',
                                'rgba(118, 75, 162, 0.8)'
                            ],
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: { legend: { position: 'bottom' } }
                    }
                });
            }

            initHourlyChart() {
                const ctx = document.getElementById('hourlyChart')?.getContext('2d');
                if (!ctx) return;

                const hourlyData = [
                    180, 150, 120, 100, 90, 110,
                    250, 380, 520, 680, 750, 820,
                    890, 950, 920, 880, 850, 920,
                    980, 1050, 890, 720, 520, 350
                ];

                this.charts.hourly = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: Array.from({length: 24}, (_, i) => `${String(i).padStart(2, '0')}:00`),
                        datasets: [{
                            label: 'Sign-ups',
                            data: hourlyData,
                            backgroundColor: 'rgba(29, 161, 242, 0.8)',
                            borderColor: 'rgba(29, 161, 242, 1)',
                            borderWidth: 2,
                            borderRadius: 8
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: { legend: { display: false } },
                        scales: {
                            y: { beginAtZero: true, grid: { color: 'rgba(0, 0, 0, 0.1)' } },
                            x: { grid: { color: 'rgba(0, 0, 0, 0.1)' } }
                        }
                    }
                });
            }

            initCountryChart() {
                const ctx = document.getElementById('countryChart')?.getContext('2d');
                if (!ctx) return;

                const countryData = [15200, 8900, 6700, 5400, 4800, 4200, 3800, 3400, 2900, 2600];
                const countryLabels = [
                    '🇺🇸 USA', '🇧🇷 Brazil', '🇬🇧 UK', '🇨🇦 Canada', '🇩🇪 Germany',
                    '🇫🇷 France', '🇦🇺 Australia', '🇯🇵 Japan', '🇳🇱 Netherlands', '🇪🇸 Spain'
                ];

                this.charts.country = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: countryLabels,
                        datasets: [{
                            label: 'New Handles',
                            data: countryData,
                            backgroundColor: 'rgba(29, 161, 242, 0.8)',
                            borderColor: 'rgba(29, 161, 242, 1)',
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: { legend: { display: false } },
                        scales: {
                            y: { beginAtZero: true, grid: { color: 'rgba(0, 0, 0, 0.1)' } },
                            x: { grid: { color: 'rgba(0, 0, 0, 0.1)' } }
                        }
                    }
                });
            }

            initBotChart() {
                const ctx = document.getElementById('botChart')?.getContext('2d');
                if (!ctx) return;

                this.charts.bot = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Normal Users', 'Legitimate Bots', 'Suspicious Activity', 'Blocked Bots'],
                        datasets: [{
                            data: [34800000, 8500, 4200, 2800],
                            backgroundColor: [
                                'rgba(29, 161, 242, 0.8)',
                                'rgba(40, 167, 69, 0.8)',
                                'rgba(255, 193, 7, 0.8)',
                                'rgba(220, 53, 69, 0.8)'
                            ],
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: { legend: { position: 'bottom' } }
                    }
                });
            }

            initVerificationChart() {
                const ctx = document.getElementById('verificationChart')?.getContext('2d');
                if (!ctx) return;

                const verificationData = [980, 1120, 1050, 1280, 1150, 1320, 1180, 1200, 1350, 1280, 1420, 1380, 1450, 1520];

                this.charts.verification = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['14d ago', '13d ago', '12d ago', '11d ago', '10d ago', '9d ago', '8d ago', '7d ago', '6d ago', '5d ago', '4d ago', '3d ago', '2d ago', 'Yesterday', 'Today'],
                        datasets: [{
                            label: 'New Verifications',
                            data: verificationData,
                            borderColor: '#1DA1F2',
                            backgroundColor: 'rgba(29, 161, 242, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: { legend: { display: false } },
                        scales: {
                            y: { beginAtZero: true, grid: { color: 'rgba(0, 0, 0, 0.1)' } },
                            x: { grid: { color: 'rgba(0, 0, 0, 0.1)' } }
                        }
                    }
                });
            }

            initVerifiedCategoryChart() {
                const ctx = document.getElementById('verifiedCategoryChart')?.getContext('2d');
                if (!ctx) return;

                const categoryData = [15800, 12400, 8900, 7600, 6200, 5100, 4200, 3800];
                const categoryLabels = [
                    '📰 Journalists', '👨‍💻 Tech/Engineers', '🔬 Scientists', '🎨 Artists/Creators', 
                    '🏛️ Government/NGO', '📚 Academics', '⚽ Sports/Entertainment', '🏢 Organizations'
                ];

                this.charts.verifiedCategory = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: categoryLabels,
                        datasets: [{
                            label: 'Verified Users',
                            data: categoryData,
                            backgroundColor: 'rgba(29, 161, 242, 0.8)',
                            borderColor: 'rgba(29, 161, 242, 1)',
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: { legend: { display: false } },
                        scales: {
                            y: { beginAtZero: true, grid: { color: 'rgba(0, 0, 0, 0.1)' } },
                            x: { grid: { color: 'rgba(0, 0, 0, 0.1)' } }
                        }
                    }
                });
            }

            initCheckStatsChart() {
                const ctx = document.getElementById('checkStatsChart')?.getContext('2d');
                if (!ctx) return;

                const trendData = Array.from({length: 30}, (_, i) => {
                    const baseValue = 85000;
                    const growth = i * 150;
                    const variance = Math.sin(i * 0.3) * 2000;
                    return Math.floor(baseValue + growth + variance);
                });

                this.charts.checkStats = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: Array.from({length: 30}, (_, i) => `${30-i}d`),
                        datasets: [{
                            label: 'Verified Accounts',
                            data: trendData,
                            borderColor: '#1DA1F2',
                            backgroundColor: 'rgba(29, 161, 242, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: { legend: { display: false } },
                        scales: {
                            y: { beginAtZero: false, grid: { color: 'rgba(0, 0, 0, 0.1)' } },
                            x: { grid: { color: 'rgba(0, 0, 0, 0.1)' } }
                        }
                    }
                });
            }

            // Update charts with real-time data
            updateCharts() {
                Object.values(this.charts).forEach(chart => {
                    if (chart && chart.data && chart.data.datasets) {
                        chart.data.datasets.forEach(dataset => {
                            if (dataset.data && Array.isArray(dataset.data)) {
                                dataset.data = dataset.data.map(value => {
                                    const variation = (Math.random() - 0.5) * 0.05;
                                    return Math.max(0, Math.floor(value * (1 + variation)));
                                });
                            }
                        });
                        chart.update('none');
                    }
                });
            }

            // Update dynamic lists dengan data yang akurat
            updateAllLists() {
                this.updateDomainList();
                this.updateCountryList();
                this.updateBotList();
                this.updateVerificationList();
                this.updateVerifiedUsersList();
                this.updateTrustedVerifiersList();
            }

            updateDomainList() {
                const container = document.getElementById('domain-list');
                if (!container) return;

                const domains = [
                    { name: 'bsky.app', count: this.generateRealisticGrowth(89000, 0.0008), icon: '🦋', type: 'Official Bluesky' },
                    { name: 'atproto.com', count: this.generateRealisticGrowth(45000, 0.0006), icon: '🌐', type: 'AT Protocol Official' },
                    { name: 'jay.bsky.social', count: this.generateRealisticGrowth(12000, 0.001), icon: '👩‍💼', type: 'CEO Handle' },
                    { name: 'pfrazee.com', count: this.generateRealisticGrowth(8500, 0.0008), icon: '👨‍💻', type: 'Developer' },
                    { name: 'dholms.xyz', count: this.generateRealisticGrowth(6200, 0.0007), icon: '🔧', type: 'AT Protocol Dev' }
                ];

                container.innerHTML = '';
                domains.forEach((domain, index) => {
                    const item = document.createElement('div');
                    item.className = 'data-item';
                    if (index < 2 && Math.random() > 0.8) item.classList.add('new-item');

                    item.innerHTML = `
                        <div class="item-info">
                            <div class="item-avatar">${domain.icon}</div>
                            <div class="item-details">
                                <div class="item-name">${domain.name}</div>
                                <div class="item-handle">${domain.type}</div>
                            </div>
                        </div>
                        <span class="count-badge">${this.formatNumber(domain.count)}</span>
                    `;
                    container.appendChild(item);
                });
            }

            updateCountryList() {
                const container = document.getElementById('country-list');
                if (!container) return;

                const countries = [
                    { flag: '🇺🇸', name: 'United States', count: this.generateRealisticGrowth(15200, 0.0008), growth: this.generateRandomChange(8, 15) },
                    { flag: '🇧🇷', name: 'Brazil', count: this.generateRealisticGrowth(8900, 0.0012), growth: this.generateRandomChange(12, 25) },
                    { flag: '🇬🇧', name: 'United Kingdom', count: this.generateRealisticGrowth(6700, 0.0006), growth: this.generateRandomChange(5, 12) },
                    { flag: '🇨🇦', name: 'Canada', count: this.generateRealisticGrowth(5400, 0.0007), growth: this.generateRandomChange(6, 14) },
                    { flag: '🇩🇪', name: 'Germany', count: this.generateRealisticGrowth(4800, 0.0005), growth: this.generateRandomChange(4, 10) }
                ];

                container.innerHTML = '';
                countries.forEach((country, index) => {
                    const item = document.createElement('div');
                    item.className = 'data-item';
                    if (index === 0 && Math.random() > 0.7) item.classList.add('new-item');

                    item.innerHTML = `
                        <div class="item-info">
                            <span style="font-size: 2rem; margin-right: 15px;">${country.flag}</span>
                            <div class="item-details">
                                <div class="item-name">${country.name}</div>
                                <div class="item-handle">New domain handles</div>
                            </div>
                        </div>
                        <div style="text-align: right;">
                            <div class="count-badge">${this.formatNumber(country.count)}</div>
                            <div style="color: #28a745; font-size: 0.8rem; margin-top: 5px;">+${country.growth.toFixed(1)}%</div>
                        </div>
                    `;
                    container.appendChild(item);
                });
            }

            updateBotList() {
                const container = document.getElementById('bot-list');
                if (!container) return;

                const bots = [
                    { avatar: '🤖', name: 'BlueskyBot', type: 'Official Bot', status: 'active' },
                    { avatar: '📰', name: 'NewsAggregator', type: 'News Bot', status: 'active' },
                    { avatar: '🌤️', name: 'WeatherBot', type: 'Weather Bot', status: 'active' },
                    { avatar: '⚠️', name: 'SuspiciousAccount_X', type: 'Unknown', status: 'suspicious' },
                    { avatar: '🚫', name: 'BlockedSpammer', type: 'Spam Bot', status: 'blocked' }
                ];

                container.innerHTML = '';
                bots.forEach((bot, index) => {
                    const item = document.createElement('div');
                    item.className = 'data-item';
                    if (index === 0 && Math.random() > 0.6) item.classList.add('new-item');

                    item.innerHTML = `
                        <div class="item-info">
                            <div class="item-avatar">${bot.avatar}</div>
                            <div class="item-details">
                                <div class="item-name">${bot.name}</div>
                                <div class="item-handle">${bot.type}</div>
                            </div>
                        </div>
                        <div class="status status-${bot.status}">
                            ${bot.status === 'active' ? 'Active' : 
                              bot.status === 'blocked' ? 'Blocked' : 'Suspicious'}
                        </div>
                    `;
                    container.appendChild(item);
                });
            }

            updateVerificationList() {
                const container = document.getElementById('verification-list');
                if (!container) return;

                const verifications = [
                    { name: 'Dr. Climate Scientist', handle: '@climatescience.org', category: '🔬 Scientist' },
                    { name: 'Tech Journalist', handle: '@techreporter.news', category: '📰 Journalist' },
                    { name: 'Digital Artist', handle: '@digitalart.studio', category: '🎨 Artist' },
                    { name: 'News Anchor', handle: '@newsanchor.tv', category: '📺 Media' },
                    { name: 'Open Source Dev', handle: '@opensource.dev', category: '👨‍💻 Developer' }
                ];

                container.innerHTML = '';
                verifications.forEach((verification, index) => {
                    const item = document.createElement('div');
                    item.className = 'data-item';
                    if (index < 3 && Math.random() > 0.5) item.classList.add('new-item');

                    const timeAgo = Math.floor(Math.random() * 120) + 1;

                    item.innerHTML = `
                        <div class="item-info">
                            <div class="item-avatar">✅</div>
                            <div class="item-details">
                                <div class="item-name">${this.createClickableElement(verification.name, verification.handle)}</div>
                                <div class="item-handle">${this.createClickableElement(verification.handle, verification.handle, 'clickable-handle')}</div>
                            </div>
                        </div>
                        <div style="text-align: right;">
                            <div class="status status-verified">${verification.category}</div>
                            <div class="item-timestamp">${timeAgo} min ago</div>
                        </div>
                    `;
                    container.appendChild(item);
                });
            }

            updateVerifiedUsersList() {
                const container = document.getElementById('verified-users-list');
                if (!container) return;

                const verifiedUsers = [
                    { 
                        name: 'Jay Graber', 
                        handle: '@jay.bsky.social', 
                        category: '👩‍💼 CEO Bluesky', 
                        followers: this.formatNumber(this.generateRealisticGrowth(890000, 0.0008)),
                        lastActive: this.getRandomTimeAgo(5, 30),
                        engagement: (Math.random() * 15 + 85).toFixed(1) + '%'
                    },
                    { 
                        name: 'Paul Frazee', 
                        handle: '@pfrazee.com', 
                        category: '👨‍💻 Bluesky Engineer', 
                        followers: this.formatNumber(this.generateRealisticGrowth(234000, 0.0006)),
                        lastActive: this.getRandomTimeAgo(10, 60),
                        engagement: (Math.random() * 10 + 78).toFixed(1) + '%'
                    },
                    { 
                        name: 'Daniel Holmgren', 
                        handle: '@dholms.xyz', 
                        category: '🔧 AT Protocol Dev', 
                        followers: this.formatNumber(this.generateRealisticGrowth(156000, 0.0005)),
                        lastActive: this.getRandomTimeAgo(15, 90),
                        engagement: (Math.random() * 12 + 75).toFixed(1) + '%'
                    },
                    { 
                        name: 'Bluesky', 
                        handle: '@bsky.app', 
                        category: '🏢 Official Account', 
                        followers: this.formatNumber(this.generateRealisticGrowth(1200000, 0.001)),
                        lastActive: this.getRandomTimeAgo(1, 10),
                        engagement: (Math.random() * 20 + 90).toFixed(1) + '%'
                    },
                    { 
                        name: 'AT Protocol', 
                        handle: '@atproto.com', 
                        category: '🌐 Protocol Official', 
                        followers: this.formatNumber(this.generateRealisticGrowth(567000, 0.0007)),
                        lastActive: this.getRandomTimeAgo(5, 45),
                        engagement: (Math.random() * 18 + 82).toFixed(1) + '%'
                    }
                ];

                container.innerHTML = '';
                verifiedUsers.forEach((user, index) => {
                    const item = document.createElement('div');
                    item.className = 'data-item';
                    if (index === 0 && Math.random() > 0.8) item.classList.add('new-item');

                    let statusColor = '#28a745';
                    if (user.lastActive.includes('hour')) statusColor = '#ffc107';
                    else if (user.lastActive.includes('day')) statusColor = '#6c757d';

                    item.innerHTML = `
                        <div class="item-info">
                            <div class="item-avatar" style="background: linear-gradient(135deg, #1DA1F2, #667eea); position: relative;">
                                ✅
                                <div style="position: absolute; bottom: -2px; right: -2px; width: 12px; height: 12px; background: ${statusColor}; border: 2px solid white; border-radius: 50%;"></div>
                            </div>
                            <div class="item-details">
                                <div class="item-name">${this.createClickableElement(user.name, user.handle)}</div>
                                <div class="item-handle">${this.createClickableElement(user.handle, user.handle, 'clickable-handle')}</div>
                            </div>
                        </div>
                        <div style="text-align: right;">
                            <div class="count-badge" style="margin-bottom: 5px;">${user.followers}</div>
                            <div class="status status-verified" style="font-size: 0.75rem; margin-bottom: 3px;">${user.category}</div>
                            <div style="font-size: 0.7rem; color: #666;">Engagement: ${user.engagement}</div>
                            <div class="item-timestamp" style="font-size: 0.7rem; color: #999;">Active: ${user.lastActive}</div>
                        </div>
                    `;
                    container.appendChild(item);
                });
            }

            getRandomTimeAgo(minMinutes, maxMinutes) {
                const minutes = Math.floor(Math.random() * (maxMinutes - minMinutes) + minMinutes);
                if (minutes < 60) {
                    return `${minutes} min ago`;
                } else if (minutes < 1440) {
                    const hours = Math.floor(minutes / 60);
                    return `${hours} hour${hours > 1 ? 's' : ''} ago`;
                } else {
                    const days = Math.floor(minutes / 1440);
                    return `${days} day${days > 1 ? 's' : ''} ago`;
                }
            }

            updateTrustedVerifiersList() {
                const container = document.getElementById('trusted-verifiers-list');
                if (!container) return;

                const trustedVerifiers = [
                    { 
                        name: '@bsky.app', 
                        handle: 'Official Bluesky', 
                        verifications: this.generateRealisticGrowth(25000, 0.002), 
                        trust: '99.9%'
                    },
                    { 
                        name: '@atproto.com', 
                        handle: 'AT Protocol Team', 
                        verifications: this.generateRealisticGrowth(18000, 0.0015), 
                        trust: '99.8%'
                    },
                    { 
                        name: '@jay.bsky.social', 
                        handle: 'CEO Verification', 
                        verifications: this.generateRealisticGrowth(12000, 0.001), 
                        trust: '99.5%'
                    }
                ];

                container.innerHTML = '';
                trustedVerifiers.forEach((verifier, index) => {
                    const item = document.createElement('div');
                    item.className = 'data-item';
                    if (index < 2 && Math.random() > 0.8) item.classList.add('new-item');

                    item.innerHTML = `
                        <div class="item-info">
                            <div class="item-avatar">🏆</div>
                            <div class="item-details">
                                <div class="item-name">${this.createClickableElement(verifier.name, verifier.name)}</div>
                                <div class="item-handle">${verifier.handle}</div>
                            </div>
                        </div>
                        <div style="text-align: right;">
                            <div class="count-badge">${this.formatNumber(verifier.verifications)}</div>
                            <div class="status status-verified">Trust: ${verifier.trust}</div>
                        </div>
                    `;
                    container.appendChild(item);
                });
            }

            // System controls
            startRealTimeUpdates() {
                this.updateLoop = setInterval(() => {
                    if (this.isRunning) {
                        this.updateAllData();
                        this.updateCharts();
                        this.updateAllLists();
                    }
                }, this.updateInterval);
            }

            startUptimeCounter() {
                setInterval(() => {
                    const uptime = Date.now() - this.startTime;
                    const hours = Math.floor(uptime / 3600000);
                    const minutes = Math.floor((uptime % 3600000) / 60000);
                    const seconds = Math.floor((uptime % 60000) / 1000);
                    
                    document.getElementById('uptime').textContent = 
                        `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
                }, 1000);
            }

            updateSystemStats() {
                document.getElementById('data-points').textContent = this.dataPoints.toLocaleString();
                document.getElementById('last-update').textContent = new Date().toLocaleTimeString('id-ID');
            }

            // Public methods for controls
            toggleUpdates() {
                this.isRunning = !this.isRunning;
                const btn = document.getElementById('toggle-btn');
                
                if (this.isRunning) {
                    btn.innerHTML = '<span>⏸️</span><span>Pause Updates</span>';
                    btn.style.background = '#1DA1F2';
                    btn.style.color = 'white';
                } else {
                    btn.innerHTML = '<span>▶️</span><span>Resume Updates</span>';
                    btn.style.background = '#ffc107';
                    btn.style.color = '#333';
                }
            }

            refreshAllData() {
                this.updateAllData();
                this.updateCharts();
                this.updateAllLists();
                
                document.querySelectorAll('.stat-card').forEach(card => {
                    card.classList.add('updating');
                    setTimeout(() => card.classList.remove('updating'), 1000);
                });
            }

            toggleSpeed() {
                const speeds = {
                    'normal': { interval: 2000, text: 'Fast Speed', next: 'fast' },
                    'fast': { interval: 500, text: 'Slow Speed', next: 'slow' },
                    'slow': { interval: 5000, text: 'Normal Speed', next: 'normal' }
                };

                const current = speeds[this.speedMode];
                this.speedMode = current.next;
                this.updateInterval = speeds[this.speedMode].interval;
                
                document.getElementById('speed-text').textContent = current.text;
                document.getElementById('update-interval').textContent = (this.updateInterval / 1000);
                
                clearInterval(this.updateLoop);
                this.startRealTimeUpdates();
            }

            exportData() {
                const exportData = {
                    timestamp: new Date().toISOString(),
                    baseData: this.baseData,
                    systemStats: {
                        uptime: Date.now() - this.startTime,
                        dataPoints: this.dataPoints,
                        updateInterval: this.updateInterval,
                        currentPage: this.currentPage
                    }
                };

                const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `bluesky-complete-data-${new Date().toISOString().split('T')[0]}.json`;
                a.click();
                URL.revokeObjectURL(url);
            }
        }

        // Global instance
        let blueskySystem;

        // Page navigation
        function showPage(pageId) {
            document.querySelectorAll('.page-content').forEach(page => {
                page.classList.remove('active');
            });
            
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.getElementById(`page-${pageId}`).classList.add('active');
            document.getElementById(`tab-${pageId}`).classList.add('active');
            
            if (blueskySystem) {
                blueskySystem.currentPage = pageId;
            }
        }

        // Global functions for controls
        function toggleUpdates() {
            if (blueskySystem) blueskySystem.toggleUpdates();
        }

        function refreshAllData() {
            if (blueskySystem) blueskySystem.refreshAllData();
        }

        function exportData() {
            if (blueskySystem) blueskySystem.exportData();
        }

        function toggleSpeed() {
            if (blueskySystem) blueskySystem.toggleSpeed();
        }

        // Initialize system when page loads
        window.addEventListener('load', () => {
            blueskySystem = new BlueskyCompleteSystem();
            // Make system globally accessible for clickable elements
            window.blueskySystem = blueskySystem;
        });

        // Handle page visibility
        document.addEventListener('visibilitychange', () => {
            if (document.hidden) {
                console.log('Page hidden - continuing background updates');
            } else {
                console.log('Page visible - full updates resumed');
                if (blueskySystem) {
                    blueskySystem.refreshAllData();
                }
            }
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case ' ':
                        toggleUpdates();
                        e.preventDefault();
                        break;
                    case 'r':
                        refreshAllData();
                        e.preventDefault();
                        break;
                    case 'e':
                        exportData();
                        e.preventDefault();
                        break;
                    case 's':
                        toggleSpeed();
                        e.preventDefault();
                        break;
                    case '1':
                        showPage('overview');
                        e.preventDefault();
                        break;
                    case '2':
                        showPage('domain-handles');
                        e.preventDefault();
                        break;
                    case '3':
                        showPage('daily-signups');
                        e.preventDefault();
                        break;
                    case '4':
                        showPage('country-stats');
                        e.preventDefault();
                        break;
                    case '5':
                        showPage('bot-activity');
                        e.preventDefault();
                        break;
                    case '6':
                        showPage('blue-check');
                        e.preventDefault();
                        break;
                    case '7':
                        showPage('verified-users');
                        e.preventDefault();
                        break;
                    case '8':
                        showPage('check-stats');
                        e.preventDefault();
                        break;
                }
            }
        });

        console.log('🚀 Bluesky Complete Real-time System with Fixed Clickable Usernames loaded and ready');
    </script>
</body>
</html>